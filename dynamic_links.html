<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Links</title>
    <script>
        // Obfuscated password (simple obfuscation for demonstration)
        const obfuscatedPassword = [112, 97, 115, 115, 119, 111, 114, 100];  // 'password' in ASCII

        // CJ parameters
        const websiteId = 101231518;
        const trackingServerDomain = 'www.qksrv.net';
        const generateLinkOnLoad = false;
        const publisherId = 7194971;
        const sid = undefined;  // Optional
        const debug = false;

        // Function to log debugging information
        function log(consoleStr){
            if (debug && window.console){
                console.log(consoleStr);
            }
        }

        // Function to check if the provided password is correct
        function isPasswordCorrect(inputPassword) {
            const decodedPassword = String.fromCharCode(...obfuscatedPassword);
            return inputPassword === decodedPassword;
        }

        // Function to get the domain and protocol from a URL
        function getDomainAndProtocol(url) {
            const matches = url.match(/^(https?)\:\/\/([^\/?#]+)(?:[\/?#]|$)/i);
            const protocol = matches && matches[1];
            const domain = matches && matches[2];
            return { domain: domain, protocol: protocol };
        }

        // Function to auto-monetize a link
        function autoMonetizeLink(url){
            const domainAndProtocol = getDomainAndProtocol(url);
            if (!domainAndProtocol.domain) return url;

            const domainInLowerCase = domainAndProtocol.domain.toLowerCase();
            if (domainInLowerCase) { // You might want to add a domain check here
                log("Domain found. Automonetizing...");
                let extraParams = "";
                if (sid) {
                    extraParams = "/sid/" + sid;
                }
                const monetizedUrl = "https://" + trackingServerDomain + "/links/" + websiteId + "/type/am" + extraParams + "/" + encodeURIComponent(url);
                return monetizedUrl;
            } else {
                log("Domain not found. Returning original URL.");
                return url;
            }
        }

        // Function to dynamically add a link and simulate a click
        function addLinkAndClick(url) {
            // Convert the link to an affiliate link
            const monetizedUrl = autoMonetizeLink(url);

            // Check if the link already exists
            if (!document.querySelector(`a[href='${monetizedUrl}']`)) {
                // Create a new anchor element
                const newLink = document.createElement('a');
                newLink.href = monetizedUrl;
                newLink.textContent = 'Hidden Link';
                newLink.style.display = 'none'; // Hide the link from view

                // Add the link to the body
                document.body.appendChild(newLink);

                // Simulate a click on the new link
                newLink.click();
            } else {
                // If the link exists, click it directly
                document.querySelector(`a[href='${monetizedUrl}']`).click();
            }
        }

        // Parse the query parameters from the URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // On page load, check the password and add/click the link if valid
        document.addEventListener('DOMContentLoaded', () => {
            const password = getQueryParam('password');
            const link = getQueryParam('link');

            if (password && isPasswordCorrect(password)) {
                if (link) {
                    addLinkAndClick(link);
                } else {
                    // If link is not provided, show an error message
                    document.body.innerHTML = "<h1>Error: Link not provided</h1>";
                }
            } else {
                // If password is incorrect or not provided, redirect to an error page
                window.location.href = 'error.html';  // You need to create this error.html page
            }
        });
    </script>
</head>
<body>
    <h1>Dynamic Links Page</h1>
    <p>This page is used to dynamically add and click on links.</p>
</body>
</html>
